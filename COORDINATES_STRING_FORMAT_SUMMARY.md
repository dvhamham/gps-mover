# ุชุญุฏูุซ ูุธุงู ุงูุฅุญุฏุงุซูุงุช ุฅูู ุชูุณูู ุงููุต - ููุฎุต ุงูุชุบููุฑุงุช

## ุงููุดููุฉ ุงูุฃุตููุฉ
ูุงู ุงููุทููุจ ุชุบููุฑ ุชูุณูู ุญูุธ ุงูุฅุญุฏุงุซูุงุช ูู:
```json
{
  "coordinates": {
    "latitude": 33.7387321,
    "longitude": -7.3898835
  }
}
```

ุฅูู:
```json
{
  "coordinates": "33.738732, -7.389884"
}
```

## ุงูุชุบููุฑุงุช ุงููุทุจูุฉ

### 1. ุชุญุฏูุซ Coordinates.kt
- ุฅุถุงูุฉ ุฏุงูุฉ `toFirestoreString()` ูุชุญููู ุงูุฅุญุฏุงุซูุงุช ุฅูู ูุต
- ุฅุถุงูุฉ ุฏุงูุฉ `fromFirestoreString()` ููุฑุงุกุฉ ุงูุฅุญุฏุงุซูุงุช ูู ุงููุต
- ุงูุญูุงุธ ุนูู ุงููุธุงุฆู ุงููุฏููุฉ ููุชูุงูู ุงูุนูุณู

```kotlin
fun toFirestoreString(): String {
    return "${String.format("%.6f", latitude)}, ${String.format("%.6f", longitude)}"
}

fun fromFirestoreString(coordString: String): Coordinates? {
    // Parse "lat, lng" string format
}
```

### 2. ุชุญุฏูุซ LocationEntity.kt
- ุชุบููุฑ `coordinates` ูู `Map<String, Any>` ุฅูู `Coordinates`
- ุชุญุฏูุซ `toFirestoreMap()` ูุงุณุชุฎุฏุงู `toFirestoreString()`
- ุชุญุฏูุซ `fromFirestoreMap()` ูุฏุนู ููุง ุงูุชูุณูููู (ูุฏูู ูุฌุฏูุฏ)

```kotlin
fun toFirestoreMap(): Map<String, Any> {
    return mapOf(
        "coordinates" to coordinates.toFirestoreString() // Save as string
    )
}
```

### 3. ุชุญุฏูุซ LocationDataMigrationService.kt
- ุฏุนู ุชุญููู ูู lat/lng ูููุตููู ุฅูู ูุต ูุงุญุฏ
- ุฏุนู ุชุญููู ูู coordinates object ุฅูู ูุต
- ุงูุชุญูู ูู ุฌููุน ุฃููุงุน ุงูุชูุณููุงุช ุงููุฏููุฉ

```kotlin
// Migration logic:
// lat/lng -> "33.738732, -7.389884"
// {latitude: x, longitude: y} -> "33.738732, -7.389884"
```

### 4. ุชุญุฏูุซ CollectionsManager.kt
- ุชุญุฏูุซ ุงููุซุงู ูู ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุธูุฑ ุงูุชูุณูู ุงูุฌุฏูุฏ

```kotlin
// mapOf(
//     "id" to "1640995200000",
//     "name" to "Sample Location", 
//     "coordinates" to "33.738732, -7.389884", // String format
//     "order" to 0
// )
```

## ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### ูุจู ุงูุชุญุฏูุซ:
```json
{
  "id": "1640995200000",
  "name": "ุงููููุน",
  "coordinates": {
    "latitude": 33.7387321,
    "longitude": -7.3898835
  },
  "order": 0
}
```

### ุจุนุฏ ุงูุชุญุฏูุซ:
```json
{
  "id": "1640995200000", 
  "name": "ุงููููุน",
  "coordinates": "33.738732, -7.389884",
  "order": 0
}
```

## ุงูุชูุงูู ุงูุนูุณู

ุงููุธุงู ูุฏุนู ูุฑุงุกุฉ ุฌููุน ุงูุชูุณููุงุช ุงููุฏููุฉ:
1. โ `lat` ู `lng` ูููุตููู
2. โ `coordinates` ูู object `{latitude: x, longitude: y}`
3. โ `coordinates` ูู string `"lat, lng"` (ุงูุฌุฏูุฏ)

ูุณูููู ุจุชุญููููุง ุชููุงุฆูุงู ุฅูู ุงูุชูุณูู ุงูุฌุฏูุฏ ุนูุฏ ุงูุญูุธ.

## ุงููุฒุงูุง

1. **ุชูููุฑ ูุณุงุญุฉ**: ุชุฎุฒูู ุฃูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ุจุณุงุทุฉ**: ุณูููุฉ ูู ุงููุฑุงุกุฉ ูุงูุนุฑุถ
3. **ุชูุงูู ุนูุณู**: ูุนูู ูุน ุฌููุน ุงูุจูุงูุงุช ุงููุฏููุฉ
4. **migration ุชููุงุฆู**: ุชุญููู ุงูุจูุงูุงุช ุงููุฏููุฉ ุชููุงุฆูุงู

## ุงุฎุชุจุงุฑ ุงููุชุงุฆุฌ

```bash
./gradlew assembleDebug
# BUILD SUCCESSFUL in 8s
```

โ ุงูุจููุฏ ูุฌุญ ุจุฏูู ุฃุฎุทุงุก
โ ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู
โ ุงูุจูุงูุงุช ุงููุฏููุฉ ุณุชูุญููู ุชููุงุฆูุงู

## ุงูุงุณุชุฎุฏุงู

ุนูุฏ ุฅุถุงูุฉ ูููุน ุฌุฏูุฏุ ุณูุชู ุญูุธู ุจุงูุชูุณูู ุงูุฌุฏูุฏ:
```kotlin
// Will save as: "coordinates": "33.738732, -7.389884"
val location = Location(
    coordinates = Coordinates(33.7387321, -7.3898835)
)
```

ุชู ุงูุงูุชูุงุก ุจูุฌุงุญ! ๐
